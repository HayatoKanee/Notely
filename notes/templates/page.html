{% extends 'base_content_without_footer.html' %}
{% block content %}
    {% if page.notebook.folder %}
     <a href={% url 'sub_folders_tab' page.notebook.folder.id %} style="color:#1b1b1b;margin-left:20px"> <i class="bi bi-arrow-left"></i> Go back</a>
    {% else %}
         <a href={% url 'folders_tab'%} style="color:#1b1b1b;margin-left:20px"> <i class="bi bi-arrow-left"></i> Go back</a>
    {% endif %}
    <canvas id="canvas"> </canvas>
    <nav class="navbar navbar-expand-lg fixed-bottom navbar-light bg-light">
    <div class="container-fluid">
        <ul class="navbar-nav mx-auto mt-2 mt-lg-0">
        <li class="nav-item">
            <button class="toolbox" id="clearAll" onclick="clearCanvas(canvas)">Clear All</button>
        </li>
        <li class="nav-item">
            <button class="toolbox" id="select" onclick="toggleSelect(this)"></button>
         </li>
        <li class="nav-item">
         <button class="toolbox" id="draw" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePen" aria-expanded="false" aria-controls="collapsePen" onclick="toggleDraw(this)"></button>
        </li>
        <li class="nav-item">
            <div style="min-height: 120px;">
                <div class="collapse collapse-horizontal" id="collapsePen">
                <div class="card card-body" style="width: 300px;">
                    <label>Pen Mode</label>
                    <select id="chooseMode">
                        <option value="circle">Circle Brush</option>
                        <option value="crayon">Crayon</option>
                        <option value="ink">Ink Pen</option>
                        <option value="fur">Fur Brush</option>
                        <option value="longfur">Long Fur Brush</option>
                        <option value="marker">Marker</option>
                        <option value="ribbon">Ribbon Brush</option>
                        <option value="shaded">Shaded Brush</option>
                        <option value="sketchy">Sketchy Brush</option>
                        <option value="spraypaint">Spray Paint</option>
                        <option value="square">Square brush</option>
                        <option value="web">Web Brush</option>

                    </select>
                    <label>Pen Colour</label>
                    <input id='choosePenColor' value="#000000" data-jscolor="">
                    <label>Pen Width</label>
                    <input id='chooseWidth' value='1' type=range min='1' max='20'>
                </div>
                </div>
            </div>
        </li>
        <li class="nav-item">
            <button class="toolbox" id="text" type="button" data-bs-toggle="collapse" data-bs-target="#collapseText" aria-expanded="false" aria-controls="collapseText" onclick="toggleText(this)">
                <span class="bi bi-journal-text"></span>
            </button>
        </li>
        <li class="nav-item">
            <div style="min-height: 120px;">
                <div class="collapse collapse-horizontal" id="collapseText">
                <div class="card card-body" style="width: 300px;">
                    <label>Text Colour</label>
                    <input id='chooseTextColor' value="#000000" data-jscolor="">
                </div>
                </div>
            </div>
        </li>
        <li class="nav-item">
            <button class="toolbox" id="upload" type="button" data-bs-toggle="collapse" data-bs-target="#collapseUpload" aria-expanded="false" aria-controls="collapseUpload"></button>
        </li>
        <li class="nav-item">
            <div style="min-height: 120px;">
                <div class="collapse collapse-horizontal" id="collapseUpload">
                <div class="card card-body" style="width: 300px;">
                    <input id="img" class="toolbox" type="file" accept="image/*">
                </div>
                </div>
            </div>
        </li>
            <li class="nav-item">
                <button class="toolbox" id="showCodeEditor"  data-bs-toggle="modal" data-bs-target="#codeEditor"> Code</button>
            </li>
    </ul>
        </div>
    </nav>
    {% include 'partials/codeEditor.html' %}
    {% block scripts %}
        {% load static %}
        <script src="{%static 'javascript/fabric.min.js'%}"></script>
        <script>
        const page_id = "{{ page.id }}";
        const drawing = '{{ page.drawing|safe}}';
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i].trim();
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        const csrf = getCookie('csrftoken');
        </script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
            <script src="{%static 'javascript/draw.js'%}"></script>
            <script src="{%static 'javascript/jscolor.js'%}"></script>
            <script src="{%static 'javascript/codemirror.js'%}"></script>
            <link rel="stylesheet" href="{%static 'css_style/codemirror.css'%}">
            <script src="{%static 'javascript/mode/python.js'%}"></script>
            <script src="{%static 'javascript/mode/javascript.js'%}"></script>
            <script src="{%static 'javascript/mode/django.js'%}"></script>
            <script src="{%static 'javascript/codeEditor.js'%}"></script>
            {% comment %} <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.4.0/fabric.min.js"></script> {% endcomment %}
            <script src="{%static 'javascript/fabric.brushes.min.js'%}"></script>
    {% endblock %}
{% endblock %}
